I"›5<h2 id="pca">PCA</h2>

<p>PCAä¸»è¦æ˜¯ç”¨äºå¤„ç†æ•°æ®å†—æ‚é—®é¢˜ï¼ŒåŠŸèƒ½æ˜¯æ•°æ®é™ç»´</p>

<h3 id="pcaæ•°å­¦åŸç†">PCAæ•°å­¦åŸç†</h3>
<p>å¯¹äºæ•°æ®é›†<script type="math/tex">X,\forall x_i \in X, x \in \mathbb{R}^d</script>ï¼Œæ¯ä¸ªæ•°æ®éƒ½æ˜¯dç»´çš„ï¼Œdç»´ç‰¹å¾è¿‡äºå†—æ‚ï¼Œä¸”å¤§éƒ¨åˆ†æ˜¯æ— ç”¨çš„ä¿¡æ¯ï¼Œå› æ­¤ï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œé™ç»´ï¼Œæå–ä¸­åŒºåˆ†åº¦å¤§çš„ç‰¹å¾ï¼ŒåŸæ•°æ®é›†æ˜ å°„è‡³ä½ç»´ç©ºé—´ã€‚</p>

<p>éœ€è¦ç”¨åˆ°çš„æ–¹æ³•ä¸ºåŸºå˜æ¢ï¼Œä¸€ä¸ªmxnçš„çŸ©é˜µï¼Œmä¸ªæ•°æ®ï¼Œæ¯ä¸ªæ•°æ®nä¸ªç‰¹å¾ï¼Œéœ€è¦å°†å…¶é™ç»´è‡³kä¸ªç‰¹å¾ï¼Œåˆ™éœ€è¦nä¸ªkç»´åŸºã€‚</p>

<ul>
  <li>é¦–å…ˆå‘é‡<script type="math/tex">x</script>åœ¨<script type="math/tex">\vec{v}</script>æ–¹å‘ä¸Šçš„æŠ•å½±ä¸ºï¼š</li>
</ul>

<script type="math/tex; mode=display">\rho(x)=\frac{\vec{v}^Tx}{\|\vec{v}\|}</script>

<ul>
  <li>å½“$\vec{v}$æ˜¯å•ä½å‘é‡æ—¶ï¼Œåˆ™æŠ•å½±ä¸ºï¼š</li>
</ul>

<script type="math/tex; mode=display">\rho(x)=\vec{v}^Tx</script>

<ul>
  <li>è®¾æ•°æ®é›†ä¸º<script type="math/tex">X_{m\times n}</script>,å¯å°†å˜åŒ–åçš„æŠ•å½±é›†ä½“è®¾ä¸º<script type="math/tex">Xv</script>ï¼Œåœ¨å„ä¸ªæ–¹å‘ä¸Šçš„æŠ•å½±ç‚¹è¶Šåˆ†æ•£ï¼Œæ–¹å·®è¶Šå¤§ï¼Œåˆ™è¯´æ˜è¿™ä¸ªç‰¹å¾å¯¹ä¸æ•°æ®é›†ä¿å­˜çš„ä¿¡æ¯é‡è¶Šå¤š</li>
  <li>åœ¨æ­¤ä¹‹å‰ï¼Œæ•°æ®é›†æ¯åˆ—ç‰¹å¾è¿›è¡Œå»å‡å€¼åŒ–å¤„ç†ï¼Œæ‰€ä»¥ä½¿å¾—<script type="math/tex">\mu(X,v)=0</script></li>
  <li>è€Œç»è¿‡æŠ•å½±å˜åŒ–åçš„ä¿¡æ¯é‡ä¸º:</li>
</ul>

<script type="math/tex; mode=display">info(X,v)=\sigma^2(X,v)=\frac{1}{m}\sum^{m}_{i=1}(v^Tx_i-\mu)^2=\frac{1}{m}(Xv)^TXv=\frac{1}{m}v^TX^TXv</script>

<ul>
  <li>ç”±äº<script type="math/tex">X</script>æ˜¯å»å‡å€¼åçš„çŸ©é˜µï¼Œ<script type="math/tex">\frac{1}{m}X^TX</script>å³ä¸º<script type="math/tex">X</script>çš„åæ–¹å·®çŸ©é˜µï¼Œè®°ä¸ºC,åˆ™<script type="math/tex">info(X,v)=v^TCv</script></li>
  <li>åˆå› ä¸ºçº¦æŸæ¡ä»¶ä¸º<script type="math/tex">v</script>ä¸ºå•ä½å‘é‡ï¼Œæ‰€ä»¥<script type="math/tex">v^Tv=1</script>ï¼Œç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•å°†çº¦æŸç›´æ¥åŠ å…¥ç›®æ ‡å‡½æ•°ï¼Œåˆ™:</li>
</ul>

<script type="math/tex; mode=display">info(X,v)=v^TCv-\lambda(v^Tv-1)</script>

<ul>
  <li>å¯¹<script type="math/tex">info(X,v)æ±‚våå¯¼</script>ï¼Œåˆ™:</li>
</ul>

<script type="math/tex; mode=display">\frac{\partial info(X,v)}{\partial v}=2Cv-2\lambda v=0</script>

<p>â€ƒâ€ƒâ€ƒ åˆ™<script type="math/tex">Cv=\lambda v</script></p>

<ul>
  <li>è¯¥å¼ç¬¦åˆçŸ©é˜µç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡çš„æ€§è´¨ï¼Œå¯ä»¥çš„å‡ºæ­¤æ—¶æ»¡è¶³æ¡ä»¶çš„<script type="math/tex">\lambda,v</script>å³ä¸ºåæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å€¼å’Œå¯¹åº”çš„ç‰¹å¾å‘é‡ã€‚</li>
  <li>å°†å…¶å¸¦å…¥<script type="math/tex">info(X,v)=v^TCv</script>å¾—åˆ°<script type="math/tex">info(X,v)=v^T\lambda v=\lambda v^Tv=\lambda</script></li>
  <li>è‡³æ­¤è¯æ¯•ï¼Œç»è¿‡æŠ•å½±åä¿å­˜çš„ä¿¡æ¯é‡ä¸ºåæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å€¼å¤§å°ï¼Œè€Œå˜æ¢åŸºä¸ºå¯¹åº”çš„ç‰¹å¾å‘é‡ã€‚</li>
  <li>é€‰å–å‰kä¸ªç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ç»„æˆåŸºçŸ©é˜µP</li>
  <li>åˆ™å˜æ¢åçš„æ•°æ®é›†ä¸º<script type="math/tex">new\_X = XP</script></li>
</ul>

<h3 id="å®ä¾‹">å®ä¾‹</h3>

<p>lrisæ•°æ®é›†åŒ…å«150ä¸ªæ•°æ®é›†ï¼Œåˆ†ä¸º3ç±»Setosa(å±±é¸¢å°¾)ï¼ŒVersicolour(å˜è‰²é¸¢å°¾)ï¼ŒVirginicaï¼ˆç»´å‰å°¼äºšé¸¢å°¾ï¼‰ï¼Œæ¯ç±»50ä¸ªæ•°æ®ï¼Œæ¯ä¸ªæ•°æ®åŒ…å«4ä¸ªå±æ€§èŠ±è¼é•¿åº¦ï¼ŒèŠ±è¼å®½åº¦ï¼ŒèŠ±ç“£é•¿åº¦ï¼ŒèŠ±ç“£å®½åº¦ï¼ˆsepal lengthï¼Œsepal width ï¼Œpetal length ï¼Œpetal width ï¼‰ã€‚</p>

<p>éƒ¨åˆ†æ•°æ®å½¢å¼å¦‚ä¸‹ï¼š
<img src="/img/in-post/PCA/1.png" width="400px" height="275px" /></p>

<p>PCAç®—æ³•æ­¥éª¤ï¼š</p>
<ol>
  <li>å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ï¼Œç‰¹å¾çš„å‡å€¼æ ‡å‡†åŒ–ä¸º0ï¼Œæ–¹å·®æ ‡å‡†åŒ–ä¸º1</li>
  <li>è®¡ç®—ç‰¹å¾çš„åæ–¹å·®çŸ©é˜µCovMat</li>
  <li>è®¡ç®—åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å€¼eigvalå’Œå¯¹åº”çš„eigvec</li>
  <li>é€‰å–å‰kä¸ªå¤§çš„eigvalæ‰€å¯¹åº”çš„eigvecä½œä¸ºåŸºç»„æˆè½¬æ¢çŸ©é˜µ</li>
  <li>å°†è½¬æ¢çŸ©é˜µä¸åŸæ•°æ®çŸ©é˜µç›¸ä¹˜å¾—åˆ°é™ç»´ç»“æœ</li>
</ol>

<p>ä»£ç å®ç°ï¼š</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'iris.csv'</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span>

<span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,:</span><span class="mi">4</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">meanvalue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">meanremove</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="n">meanvalue</span><span class="p">)</span><span class="o">/</span><span class="n">std</span>
<span class="n">meanremove</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">meanremove</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s">'float64'</span><span class="p">)</span>
<span class="n">covMat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">meanremove</span><span class="p">,</span><span class="n">rowvar</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">eigval</span><span class="p">,</span><span class="n">eigvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">covMat</span><span class="p">)</span>
<span class="n">tmpeig</span> <span class="o">=</span> <span class="n">eigval</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">chose_k</span><span class="p">(</span><span class="n">val</span><span class="p">):</span><span class="c1">#ä»å¤§åˆ°å°æ’åˆ—ç‰¹å¾å€¼ï¼Œå–ç´¯è®¡å æ¯”è¶…è¿‡95%çš„å‰kä¸ªç‰¹å¾
</span>    <span class="n">total</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="n">val</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">[(</span><span class="n">val</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span><span class="o">/</span><span class="n">total</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"ç¬¬</span><span class="si">%</span><span class="s">dç‰¹å¾æ‰€å æ¯”ä¾‹ä¸º:</span><span class="si">%</span><span class="s">f"</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.95</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"å‰</span><span class="si">%</span><span class="s">dä¸ªç‰¹å¾æ‰€å æ¯”å·²è¶…è¿‡0.95"</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>

<span class="n">k</span> <span class="o">=</span> <span class="n">chose_k</span><span class="p">(</span><span class="n">tmpeig</span><span class="p">)</span>
<span class="n">eigind</span> <span class="o">=</span> <span class="n">eigval</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
<span class="n">eigind</span> <span class="o">=</span> <span class="n">eigind</span><span class="p">[:</span><span class="o">-</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">eigvec</span><span class="p">[:,</span><span class="n">eigind</span><span class="p">]</span>
<span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">meanremove</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">color</span><span class="p">():</span><span class="c1">#ç”Ÿæˆ3ä¸ªç±»åˆ«çš„æ ‡ç­¾æ‰€å¯¹åº”çš„é¢œè‰²
</span>    <span class="n">co</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span><span class="o">/</span><span class="mf">255.0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
            <span class="n">co</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">co</span> 

<span class="n">co</span> <span class="o">=</span> <span class="n">color</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]),</span><span class="n">c</span><span class="o">=</span><span class="n">co</span><span class="p">)</span><span class="c1">#å¯è§†åŒ–
</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p>å¯è§†åŒ–ç»“æœä¸ºï¼š</p>

<p><img src="/img/in-post/PCA/2.png" width="400px" height="275px" /></p>
:ET