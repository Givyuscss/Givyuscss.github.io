I"D<h2 id="kmeans">Kmeans</h2>

<ul>
  <li>Kmeans æ˜¯ä¸€ä¸ªååˆ†ç»å…¸çš„æ— ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œå¯¹äºç»™å®šçš„æ ·æœ¬é›†åˆï¼Œæ ¹æ®æ ·æœ¬ä¹‹é—´çš„è·ç¦»å¤§å°å°†å®ƒä»¬åˆ†ä¸ºKç°‡ï¼Œä½¿å¾—ç°‡å†…æ ·æœ¬ä¹‹é—´çš„è·ç¦»å°ï¼Œç°‡é—´æ ·æœ¬çš„è·ç¦»å¤§ã€‚</li>
</ul>

<hr />

<h3 id="ä¼˜ç‚¹">ä¼˜ç‚¹</h3>
<ul>
  <li>æ— ç›‘ç£å­¦ä¹ ï¼Œæ— éœ€è®­ç»ƒé›†</li>
  <li>åŸç†ç®€å•</li>
  <li>ç»“æœå¯è§£é‡Šæ€§å¼º</li>
</ul>

<h3 id="ç¼ºç‚¹">ç¼ºç‚¹</h3>
<ul>
  <li>éœ€è¦æ‰‹åŠ¨è®¾ç½®Kå€¼ï¼Œåˆå§‹åŒ–å¯¹ç»“æœæœ‰ä¸€å®šçš„å½±å“</li>
  <li>åœ¨å¤§å‹æ•°æ®é›†ä¸­å¯èƒ½ä¼šé™·å…¥å±€éƒ¨æœ€ä¼˜</li>
  <li>å¯¹ç¦»ç¾¤ç‚¹å¼‚å¸¸ç‚¹ååˆ†æ•æ„Ÿ</li>
</ul>

<h3 id="ç®—æ³•æµç¨‹">ç®—æ³•æµç¨‹</h3>
<ul>
  <li>é€‰å®škä¸ªç±»ä¸­å¿ƒ<script type="math/tex">\{u_1,u_2,..,u_k\}</script>ï¼Œé€‰å®šä¸­å¿ƒçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œå¯ä»¥æ ¹æ®ç»éªŒé€‰æ‹©ï¼Œä¹Ÿå¯åœ¨æ ·æœ¬æ•°æ®çš„æ•°å€¼èŒƒå›´å†…è¿›è¡Œéšæœºé€‰å–ã€‚</li>
  <li>æ ¹æ®æ ·æœ¬<script type="math/tex">x_i</script>ä¸ç°‡ä¸­å¿ƒçš„è·ç¦»å°†æ ·æœ¬çš„ç±»åˆ«æ ‡è®°ä¸º<script type="math/tex">y_i</script>ï¼š</li>
  <li>è®¡ç®—æ¯ä¸ªç°‡ä¸­æ ·æœ¬çš„å‡å€¼<script type="math/tex">\hat{u}</script>ï¼Œå¹¶æ›´æ–°:<script type="math/tex">u=\hat{u}</script></li>
  <li>å½“è´¨å¿ƒä¸å†å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåœæ­¢ç®—æ³•ï¼Œå¹¶è¾“å‡ºç°‡ï¼Œåä¹‹é‡å¤è¿›è¡Œ2ï¼Œ3æ­¥ã€‚</li>
</ul>

<h3 id="å®ä¾‹">å®ä¾‹</h3>
<p>å¯¹testSet.txtæ–‡ä»¶ä¸­çš„æ•°æ®ç‚¹è¿›è¡Œèšç±»ï¼Œæ–‡ä»¶ä¸­æ•°æ®ä¸ºå¦‚ä¸‹æ ¼å¼ï¼š
<img src="/img/in-post/Kmeans/data_pic.jpg" width="200px" height="100px" /></p>

<ul>
  <li><strong>ä»£ç å®ç°</strong>
``` python
import numpy as np
import matplotlib
matplotlib.use(â€˜TkAggâ€™)
import matplotlib.pyplot as plt
import random</li>
</ul>

<p>filepath = â€˜./data/10.KMeans/testSet.txtâ€™</p>

<p>data = []
with open(filepath,â€™râ€™,encoding=â€™utf-8â€™) as f:
    lines = f.readlines()
    for line in lines:
        line = line.strip()
        line = line.split(â€˜\tâ€™)
        data.append([float(x) for x in line])
data = np.mat(data)</p>

<p>def dis(a,b):
    return np.linalg.norm(a - b)</p>

<p>def centroids(dataSet,k):
    (m,n) = dataSet[0].shape
    centers = np.zeros((k,n))
    for i in range(n):
        minl = min(dataSet[:,i])
        rangeJ = float(max(dataSet[:,i]) - minl)
        for j in range(k):
            centers[j,i] = np.mat(minl + rangeJ * random.random())
    return centers</p>

<p>def KMeans(dataSet,k,discal=dis,cen=centroids):
    length = dataSet.shape[0]
    clusterres = np.zeros((length,2))
    cens = cen(dataSet,k)
    clusterschange = True
    while clusterschange:
        clusterschange = False
        for i in range(length):
            mindis = np.Inf
            minindex = -1
            for j in range(k):
                disab = discal(dataSet[i,:],cens[j,:])
                if disab &lt; mindis:
                    mindis = disab
                    minindex = j
            if clusterres[i,0] != minindex:
                clusterschange = True
                clusterres[i,0] = minindex
                clusterres[i,1] = mindis
        for cent in range(k):
            points = []
            for i in range(length):
                if clusterres[i][0] == cent:
                    points.append(dataSet[i])
            cens[cent,:] = np.mean(points,axis=0)
    return cens,clusterres</p>

<p>cens,cluster_res = KMeans(data,4,dis,centroids)
def color(k):
    colors = []
    for i in range(k):
        colors.append(np.array((random.randint(0,255)/255.0,random.randint(0,255)/255.0,random.randint(0,255)/255.0)).reshape((1,3)))
    return colors
colors = color(4)
data = data.tolist()
cluster_res = cluster_res.tolist()
for i in range(len(data)):
    plt.scatter(data[i][0],data[i][1],s=10,c=colors[int(cluster_res[i][0])])
plt.scatter(cens[:,0],cens[:,1],c=â€™redâ€™,marker=â€™xâ€™)
plt.show()
```</p>

<ul>
  <li><strong>å¯è§†åŒ–åˆ†ç±»ç»“æœä¸ºï¼š</strong>
<img src="/img/in-post/Kmeans/result.jpg" width="400px" height="275px" /></li>
</ul>
:ET