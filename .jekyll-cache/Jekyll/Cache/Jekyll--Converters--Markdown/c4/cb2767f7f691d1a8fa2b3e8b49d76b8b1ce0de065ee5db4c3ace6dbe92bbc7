I"»D<h2 id="spectral-clustering">Spectral Clustering</h2>

<ul>
  <li>åœ¨çœ‹ã€ŠA Survey on Multi-View Clusteringã€‹æ—¶ï¼Œæ–‡ä¸­æœ‰æåˆ°ï¼Œè°±èšç±»æ˜¯å¤šè§†è§’èšç±»çš„é‡è¦åŸºç¡€ç®—æ³•ï¼Œè®°å½•ä¸€ä¸‹è°±èšç±»çš„åŸç†å’Œç®—æ³•å®ç°ã€‚</li>
  <li>ä¸Kmeansç­‰â€œä¼ ç»Ÿç®—æ³•â€ç›¸æ¯”ï¼Œè°±èšç±»æœ‰æ›´å¥½çš„æ€§èƒ½ä¸”å®ç°ç®€å•ã€‚</li>
</ul>

<hr />

<h3 id="1åº”ç”¨åœºæ™¯">1.åº”ç”¨åœºæ™¯</h3>

<p>ç»™å®šä¸€ç»„æ•°æ®ç‚¹<script type="math/tex">\{x_1,x_2,...,x_n\}</script>ï¼Œä»¥åŠæ•°æ®ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦<script type="math/tex">s_{ij}</script>ï¼Œè¡¨ç¤º<script type="math/tex">x_i</script>å’Œ<script type="math/tex">x_j</script>æ•°æ®ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚å°†æ‰€æœ‰æ•°æ®ç‚¹åˆ†ä¸ºKç±»ã€‚ä½¿å¾—ç±»å†…ç›¸ä¼¼åº¦é«˜ï¼Œç±»é—´ç›¸ä¼¼åº¦ä½ã€‚</p>

<h3 id="2ç®—æ³•å·¥å…·">2.ç®—æ³•å·¥å…·</h3>

<ul>
  <li>
    <p><strong>é‚»æ¥çŸ©é˜µ<script type="math/tex">W</script></strong>ï¼šæ„å»ºå…³äºå‘é‡<script type="math/tex">V=\{v_1,v_2,...,v_n\}</script>çš„æ— å‘å›¾<script type="math/tex">G(V,E)</script>ï¼Œ<script type="math/tex">W</script>ä¸º<script type="math/tex">G</script>çš„é‚»æ¥çŸ©é˜µï¼Œå…¶ä¸­çš„<script type="math/tex">w_{ij}</script>è¡¨ç¤º<script type="math/tex">v_i,v_j</script>ä¹‹é—´çš„è¿æ¥æƒé‡ã€‚å½“<script type="math/tex">w_{ij}=0</script>æ—¶ï¼Œè¡¨ç¤ºä¸¤ä¸ªå‘é‡æ— è¿æ¥ï¼Œä¸”æ˜¾ç„¶<script type="math/tex">w_{ij}=w_{ji}</script>ã€‚é‚»æ¥çŸ©é˜µ<script type="math/tex">W</script>é€šè¿‡ç›¸ä¼¼åº¦çŸ©é˜µ<script type="math/tex">S</script>å¾—åˆ°ï¼Œæœ‰ä¸‰ç§å¸¸è§çš„æ–¹æ³•ï¼š</p>

    <p><strong>1)<script type="math/tex">\epsilon</script>-é‚»è¿‘</strong>ï¼šæ ¹æ®ç›¸ä¼¼åº¦çŸ©é˜µ<script type="math/tex">S</script>ä¸­çš„<script type="math/tex">s_{ij}=||x_i-x_j||^2</script>
<script type="math/tex">% <![CDATA[
w_ij=
\begin{cases}
0,&s_{ij}>\epsilon\\
\epsilon,&s{ij}\leq \epsilon
\end{cases} %]]></script></p>

    <p><strong>2)Ké‚»è¿‘</strong>:Ké‚»è¿‘æœ‰ä¸¤ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§æ˜¯å½“ä¸¤ä¸ªå‘é‡åŒæ—¶åœ¨å¯¹æ–¹çš„Ké‚»è¿‘ä¸­æ‰æ»¡è¶³ï¼Œç¬¬äºŒç§æ˜¯æœ‰ä¸€&gt;ä¸ªå‘é‡åœ¨å¦ä¸€ä¸ªå‘é‡çš„Ké‚»è¿‘ä¸­å³å¯ï¼Œæ­¤æ—¶çš„<script type="math/tex">w_{ij}</script>å‡ä¸º:</p>

    <p><script type="math/tex">\begin{equation}
w_{ij}=w_{ji}=e^{\frac{||x_i-x_j||^2}{2\sigma^2}}
\end{equation}</script>
åä¹‹ä¸º0.</p>

    <p><strong>3)å…¨è¿æ¥ï¼ˆé«˜æ–¯ï¼‰</strong>:<script type="math/tex">w_{ij}</script></p>
  </li>
  <li>
    <p><strong>åº¦çŸ©é˜µ<script type="math/tex">D</script></strong>ï¼šå¦è®¾å®šå…³äºå‘é‡æ—çš„åº¦çŸ©é˜µ<script type="math/tex">D</script>ï¼Œ<script type="math/tex">d_{ij}=\sum^n_{j=1}w_{ij},w_{ij}\in W,d_{ij}\in D</script>ã€‚åº¦çŸ©é˜µè¢«å®šä¹‰ä¸ºå¯¹è§’å…ƒç´ ä¸º<script type="math/tex">[d_1,d_2,...,d_n]</script>çš„å¯¹è§’çŸ©é˜µã€‚</p>
  </li>
  <li>**æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ<script type="math/tex">LO$**ï¼šå®šä¹‰ä¸ºæ­£åˆ™åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µä¸º</script>L=D-W$$</li>
  <li>
    <p><script type="math/tex">L</script>æœ‰å¦‚ä¸‹æ€§è´¨ï¼š
1)<script type="math/tex">\forall f\in R^n,f^`Lf=\frac{1}{2}\sum^n_{i,j=1}w_{ij}(f_i-f_j)^2</script>
2)å¯¹ç§°ï¼ŒåŠæ­£å®š
3)æœ€å°ç‰¹å¾å€¼ä¸º0ï¼Œå¯¹åº”å¸¸æ•°ç‰¹å¾é¡¹é‡1
4)æœ‰nä¸ªéè´Ÿç‰¹å¾å€¼ï¼Œä¸”<script type="math/tex">0=\lambda_1\leq \lambda_2\leq ...\leq \lambda_n</script></p>
  </li>
  <li>æœ‰ä¸¤ç§æ­£è§„åŒ–çš„æ–¹å¼ï¼š
1)éšæœºæ¸¸èµ°ï¼š<script type="math/tex">L_{rw}=D^{-1}L=1-D^{-1}W</script>
2)å¯¹ç§°ï¼š<script type="math/tex">L_{sym}=D^{-1/2}WD^{-1/2}</script></li>
</ul>

<h3 id="3æœªæ­£è§„åŒ–è°±èšç±»ç®—æ³•æ­¥éª¤">3.æœªæ­£è§„åŒ–è°±èšç±»ç®—æ³•æ­¥éª¤</h3>

<ol>
  <li>é€šè¿‡ç›¸ä¼¼çŸ©é˜µ<script type="math/tex">S</script>å»ºç«‹é‚»æ¥çŸ©é˜µ<script type="math/tex">W</script>ï¼Œè®¾å®šåˆ†ç±»ä¸ªæ•°k</li>
  <li>é€šè¿‡é‚»æ¥çŸ©é˜µè®¡ç®—åº¦çŸ©é˜µ<script type="math/tex">D</script></li>
  <li>è®¡ç®—æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ<script type="math/tex">L</script></li>
  <li>è®¡ç®—<script type="math/tex">L</script>çš„å‰kå°çš„ç‰¹å¾å€¼æ‰€å¯¹åº”çš„ç‰¹å¾å‘é‡<script type="math/tex">\{u_1,u_2,...,u_k\}</script></li>
  <li>å°†<script type="math/tex">\{u_1,u_2,...,u_k\}</script>ä¸­æ¯ä¸ªå‘é‡ä½œä¸ºçŸ©é˜µ<script type="math/tex">U</script>çš„åˆ—</li>
  <li>è®¾<script type="math/tex">y_i</script>ä¸º<script type="math/tex">U</script>ä¸­ç¬¬iè¡Œçš„å‘é‡ï¼Œå³<script type="math/tex">y_1=[u_{11},u_{12},...,u_{1k}]</script></li>
  <li>é‡‡ç”¨Kmeanså¯¹<script type="math/tex">y_i,i=1,2,..,n</script>åˆ†ç±»ï¼Œåˆ†å‡ºç»“æœ<script type="math/tex">A_1,A_2,...,A_k</script></li>
</ol>

<p><strong>Pythonå®ç°ï¼š</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1">#ç”Ÿæˆæ•°æ®ç‚¹ï¼Œmake_moonsç”Ÿæˆä¸ºä¸¤ä¸ªæœˆç‰™å½¢
</span><span class="k">def</span> <span class="nf">circle_data</span><span class="p">(</span><span class="n">num_sample</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_moons</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="n">num_sample</span><span class="p">,</span><span class="n">noise</span><span class="o">=</span><span class="mf">0.08</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span><span class="n">y</span>

<span class="c1">#ç”Ÿæˆé‚»æ¥çŸ©é˜µW
</span><span class="k">def</span> <span class="nf">w_matrix</span><span class="p">(</span><span class="n">sample_data</span><span class="p">):</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_data</span><span class="p">)</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">length</span><span class="p">,</span><span class="n">length</span><span class="p">))</span>
    <span class="n">dis_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">length</span><span class="p">,</span><span class="n">length</span><span class="p">))</span>
    <span class="c1">#è®¡ç®—è·ç¦»çŸ©é˜µD
</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">length</span><span class="p">):</span>
            <span class="n">dis_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sample_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">sample_data</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">dis_matrix</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dis_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
    <span class="c1">#é€šè¿‡KNNç”Ÿæˆé‚»æ¥çŸ©é˜µW
</span>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">each</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dis_matrix</span><span class="p">):</span>
        <span class="n">index_array</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">each</span><span class="p">)</span>
        <span class="n">W</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">index_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># è·ç¦»æœ€çŸ­çš„æ˜¯è‡ªå·±
</span>    <span class="n">tmp_W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
    <span class="n">W</span> <span class="o">=</span> <span class="p">(</span><span class="n">tmp_W</span><span class="o">+</span><span class="n">W</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">W</span>

<span class="c1">#ç”Ÿæˆåº¦çŸ©é˜µD
</span><span class="k">def</span> <span class="nf">d_matrix</span><span class="p">(</span><span class="n">Wmatrix</span><span class="p">):</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Wmatrix</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">length</span><span class="p">,</span><span class="n">length</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">Wmatrix</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">d</span>

<span class="c1">#ç”Ÿæˆéšæœºé¢œè‰²æ ‡è®°ä¸åŒç±»åˆ«çš„æ•°æ®ç‚¹
</span><span class="k">def</span> <span class="nf">randRGB</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span>
            <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span>
            <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="o">/</span><span class="mf">255.0</span><span class="p">)</span>

<span class="c1">#æ ¹æ®æ•°æ®ç‚¹æ ‡ç­¾ç”Ÿæˆå›¾åƒ
</span><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">n_clustering</span><span class="p">):</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_clustering</span><span class="p">):</span>
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">randRGB</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">matrix</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">idx</span><span class="p">])])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#é¢„è®¾å‚æ•°
</span><span class="n">num_sample</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">n_clustering</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1">#ç”ŸæˆWï¼ŒDï¼ŒLçŸ©é˜µ
</span><span class="n">X</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">circle_data</span><span class="p">(</span><span class="n">num_sample</span><span class="p">)</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">w_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">d_matrix</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">D</span> <span class="o">-</span> <span class="n">W</span>

<span class="c1">#è®¡ç®—æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡
</span><span class="n">x</span><span class="p">,</span><span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">dictEigval</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">dim</span><span class="p">)))</span>
<span class="c1">#æ’åºå¹¶é€‰å–å‰Kä¸ªç‰¹å¾å€¼æ‰€å¯¹åº”çš„ç‰¹å¾å‘é‡
</span><span class="n">kEig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_clustering</span><span class="p">]</span>
<span class="n">ix</span> <span class="o">=</span> <span class="p">[</span><span class="n">dictEigval</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kEig</span><span class="p">]</span>
<span class="n">x</span><span class="p">,</span><span class="n">V</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span><span class="n">V</span><span class="p">[:,</span><span class="n">ix</span><span class="p">]</span>

<span class="c1">#ç”¨KMeanså¯¹ç‰¹å¾å‘é‡èšç±»
</span><span class="n">sp_cluster</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clustering</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">sp_cluster</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span><span class="n">n_clustering</span><span class="o">=</span><span class="n">n_clustering</span><span class="p">)</span>
</code></pre></div></div>

<p>èšç±»æ•ˆæœå¯¹æ¯”ï¼š</p>

<p>Spectral clustering:</p>

<p><img src="/img/in-post/clustering/result_sp.png" width="400px" height="275px" /></p>

<p>Kmeansï¼š</p>

<p><img src="/img/in-post/clustering/result_km.png" width="400px" height="275px" /></p>
:ET